\documentclass[10pt]{article}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[russian]{babel}

\usepackage[landscape, a4paper, margin=1cm]{geometry}

\usepackage{graphics} % поворот текста на 90 градусов
\usepackage{array} % типы столбцов

\usepackage{makecell} % объединение строк в одну клетку


\def\monday{Понедельник}
\def\tuesday{Вторник}
\def\wednesday{Среда}
\def\thursday{Четверг}
\def\friday{Пятница}
\def\saturday{Суббота}

\def\oddWeek{Нечётная}
\def\evenWeek{Чётная}

\newcommand\lessonNum[3]{\textbf{#1.} \\ #2 \\ #3}
\def\firstLesson{\lessonNum{1}{9:00}{10:30}}
\def\secondLesson{\lessonNum{2}{10:40}{12:10}}
\def\thirdLesson{\lessonNum{3}{12:40}{14:10}}
\def\fourthLesson{\lessonNum{4}{14:20}{15:50}}
\def\fifthLesson{\lessonNum{5}{16:20}{17:50}}
\def\sixthLesson{\lessonNum{6}{18:00}{19:30}}
\def\seventhLesson{\lessonNum{7}{19:40}{21:00}}

\newcommand\lessonWithoutHline[2]{
    \begin{tabular}{@{\hspace{.0001\textwidth}}c@{\hspace{.01\textwidth}}m{.11\textwidth}@{\hspace{0.0001\textwidth}}}
        \makecell{#1} & #2
    \end{tabular}
}

\newcommand\lessonWithHline[2]{
    \begin{tabular}{@{\hspace{.0001\textwidth}}c@{\hspace{.01\textwidth}}m{.11\textwidth}@{\hspace{0.0001\textwidth}}}
        \makecell{#1} & #2 \\ \hline
    \end{tabular}
}

\newcommand\weekDay[7]{
    \makecell{
        \setbox0=\hbox{#1\unskip}\ifdim\wd0=0pt 
        \else 
            \setbox0=\hbox{#2#3#4#5#6#7\unskip}\ifdim\wd0=0pt 
                \lessonWithoutHline{\firstLesson}{#1}
            \else
                \lessonWithHline{\firstLesson}{#1}
            \fi
            \\
        \fi 
        \setbox0=\hbox{#2\unskip}\ifdim\wd0=0pt 
        \else 
            \setbox0=\hbox{#3#4#5#6#7\unskip}\ifdim\wd0=0pt
                \lessonWithoutHline{\secondLesson}{#2} 
            \else
                \lessonWithHline{\secondLesson}{#2}
            \fi
            \\
        \fi 
        \setbox0=\hbox{#3\unskip}\ifdim\wd0=0pt 
        \else 
            \setbox0=\hbox{#4#5#6#7\unskip}\ifdim\wd0=0pt
                \lessonWithoutHline{\thirdLesson}{#3}
            \else
                \lessonWithHline{\thirdLesson}{#3}
            \fi
            \\
        \fi
        \setbox0=\hbox{#4\unskip}\ifdim\wd0=0pt 
        \else 
            \setbox0=\hbox{#5#6#7\unskip}\ifdim\wd0=0pt
                \lessonWithoutHline{\fourthLesson}{#4}
            \else
                \lessonWithHline{\fourthLesson}{#4}
            \fi
            \\
        \fi
        \setbox0=\hbox{#5\unskip}\ifdim\wd0=0pt 
        \else 
            \setbox0=\hbox{#6#7\unskip}\ifdim\wd0=0pt
                \lessonWithoutHline{\fifthLesson}{#5}
            \else
                \lessonWithHline{\fifthLesson}{#5}
            \fi
            \\
        \fi 
        \setbox0=\hbox{#6\unskip}\ifdim\wd0=0pt 
        \else 
            \setbox0=\hbox{#7\unskip}\ifdim\wd0=0pt
                \lessonWithoutHline{\sixthLesson}{#6}
            \else
                \lessonWithHline{\sixthLesson}{#6}
            \fi
            \\
        \fi 
        \setbox0=\hbox{#7\unskip}\ifdim\wd0=0pt
        \else 
            \lessonWithoutHline{\seventhLesson}{#7}
        \fi
    }
}


\begin{document}

\pagestyle{empty} % выкл. нумерацию страниц

\begin{center}
    \Large{Расписание РТУ МИРЭА} \\
    \large{Группа: АААА-01-21 \qquad Дата создания: \today}
\end{center}


\begin{center}
\footnotesize
\begin{tabular}{|c||*{6}{@{\hspace{.001\textwidth}}c@{\hspace{.001\textwidth}}|}}
    \hline
        \textnumero & \monday & \tuesday & \wednesday & \thursday & \friday & \saturday \\ \hline \hline
        
        % Нечётная неделя
        \rotatebox{90}{\oddWeek} & 
        
        %% Понедельник, нечётная неделя
        \weekDay
        {} % Нечёт, пн, 1 пара
        {} % Нечёт, пн, 2 пара
        {} % Нечёт, пн, 3 пара
        {} % Нечёт, пн, 4 пара
        {} % Нечёт, пн, 5 пара
        {} % Нечёт, пн, 6 пара
        {} % Нечёт, пн, 7 пара
        
        & 
    
        %% Вторник, нечётная неделя
        \weekDay
        {} % Нечёт, вт, 1 пара
        {} % Нечёт, вт, 2 пара
        {} % Нечёт, вт, 3 пара
        {} % Нечёт, вт, 4 пара
        {} % Нечёт, вт, 5 пара
        {} % Нечёт, вт, 6 пара
        {} % Нечёт, вт, 7 пара
        
        &
    
        %% Среда, нечётная неделя
        \weekDay
        {} % Нечёт, ср, 1 пара
        {} % Нечёт, ср, 2 пара
        {} % Нечёт, ср, 3 пара
        {} % Нечёт, ср, 4 пара
        {} % Нечёт, ср, 5 пара
        {} % Нечёт, ср, 6 пара
        {} % Нечёт, ср, 7 пара
        
        &
    
        %% Четверг, нечётная неделя
        \weekDay
        {} % Нечёт, чт, 1 пара
        {} % Нечёт, чт, 2 пара
        {} % Нечёт, чт, 3 пара
        {} % Нечёт, чт, 4 пара
        {} % Нечёт, чт, 5 пара
        {} % Нечёт, чт, 6 пара
        {} % Нечёт, чт, 7 пара
        
        &
    
        %% Пятница, нечётная неделя
        \weekDay
        {} % Нечёт, пт, 1 пара
        {} % Нечёт, пт, 2 пара
        {} % Нечёт, пт, 3 пара
        {} % Нечёт, пт, 4 пара
        {} % Нечёт, пт, 5 пара
        {} % Нечёт, пт, 6 пара
        {} % Нечёт, пт, 7 пара
        
        &
    
        %% Суббота, нечётная неделя
        \weekDay
        {} % Нечёт, сб, 1 пара
        {} % Нечёт, сб, 2 пара
        {} % Нечёт, сб, 3 пара
        {} % Нечёт, сб, 4 пара
        {} % Нечёт, сб, 5 пара
        {} % Нечёт, сб, 6 пара
        {} % Нечёт, сб, 7 пара
    
        \\ \hline
        
        % Чётная неделя
        \rotatebox{90}{\evenWeek} &
        
        %% Понедельник, чётная неделя
        \weekDay
        {} % Чёт, пн, 1 пара
        {} % Чёт, пн, 2 пара
        {} % Чёт, пн, 3 пара
        {} % Чёт, пн, 4 пара
        {} % Чёт, пн, 5 пара
        {} % Чёт, пн, 6 пара
        {} % Чёт, пн, 7 пара
        
        &
        
        %% Вторник, чётная неделя
        \weekDay
        {} % Чёт, вт, 1 пара
        {} % Чёт, вт, 2 пара
        {} % Чёт, вт, 3 пара
        {} % Чёт, вт, 4 пара
        {} % Чёт, вт, 5 пара
        {} % Чёт, вт, 6 пара
        {} % Чёт, вт, 7 пара
        
        &
        
        %% Среда, чётная неделя
        \weekDay
        {} % Чёт, ср, 1 пара
        {} % Чёт, ср, 2 пара
        {} % Чёт, ср, 3 пара
        {} % Чёт, ср, 4 пара
        {} % Чёт, ср, 5 пара
        {} % Чёт, ср, 6 пара
        {} % Чёт, ср, 7 пара
        
        &
        
        %% Четверг, чётная неделя
        \weekDay
        {} % Чёт, чт, 1 пара
        {} % Чёт, чт, 2 пара
        {} % Чёт, чт, 3 пара
        {} % Чёт, чт, 4 пара
        {} % Чёт, чт, 5 пара
        {} % Чёт, чт, 6 пара
        {} % Чёт, чт, 7 пара
        
        &
        
        %% Пятница, чётная неделя
        \weekDay
        {} % Чёт, пт, 1 пара
        {} % Чёт, пт, 2 пара
        {} % Чёт, пт, 3 пара
        {} % Чёт, пт, 4 пара
        {} % Чёт, пт, 5 пара
        {} % Чёт, пт, 6 пара
        {} % Чёт, пт, 7 пара
        
        &
        
        %% Суббота, чётная неделя
        \weekDay
        {} % Чёт, сб, 1 пара
        {} % Чёт, сб, 2 пара
        {} % Чёт, сб, 3 пара
        {} % Чёт, сб, 4 пара
        {} % Чёт, сб, 5 пара
        {} % Чёт, сб, 6 пара
        {} % Чёт, сб, 7 пара
    
        \\ \hline
    \end{tabular}
\end{center}


\end{document}
